## Table of Contents

- [Internal Network Penetration Testing Guidelines](#internal-network-penetration-testing-guidelines)
	- [Scope](#scope)
- [Host Discovery](#host-discovery)
- [Service Discovery and Port Scanning](#service-discovery-and-port-scanning)
- [Vulnerability Scanning](#vulnerability-scanning)
- [Web-Based Attack Surfaces](#web-based-attack-surfaces)
- [Generating Payloads](#generating-payloads)


# Internal Network Penetration Testing Guidelines
1. **This guide is intended to provide a general framework for creating your documentation. While it outlines key elements to consider, you are encouraged to include any additional relevant information that may be necessary to produce a comprehensive and well-structured report on an internal network assessment.**
2. **Generally, most of the scenarios given are just to emulate the real world. They are made to test your ability to demonstrate how you will approach a network penetration test in an organizational setting.**
3. **The output of the commands you run are not of interest here.**

## Scope
The scope of engagement comprises of an internal network: `10.10.10.0/24` and a domain name: `https://virtualinfosecafrica.com/`

# Host Discovery
- Using _Nmap_, demonstrate how you will do a host discovery on the scope above. Describe what it means to do a host discovery and include screenshots of the commands you would use with nmap to do a host discovery with explanations on the options you chose for the command
- Assuming 15 hosts are up, what will be your next steps? Demonstrate how you will filter your output and save them into a file indicating hosts which are up.
- Use the _Nmap_ output below to demonstrate the above point. 

```nmap 
Nmap scan report for 10.10.10.1
Host is up (0.0010s latency).
Nmap scan report for 10.10.10.2
Host is up (0.0011s latency).
Nmap scan report for 10.10.10.5
Host is up (0.0012s latency).
Nmap scan report for 10.10.10.10
Host is up (0.0015s latency).
Nmap scan report for 10.10.10.11
Host is up (0.0014s latency).
Nmap scan report for 10.10.10.15
Host is up (0.0017s latency).
Nmap scan report for 10.10.10.20
Host is up (0.0020s latency).
Nmap scan report for 10.10.10.21
Host is up (0.0018s latency).
Nmap scan report for 10.10.10.30
Host is up (0.0019s latency).
Nmap scan report for 10.10.10.31
Host is up (0.0017s latency).
Nmap scan report for 10.10.10.40
Host is up (0.0016s latency).
Nmap scan report for 10.10.10.45
Host is up (0.0022s latency).
Nmap scan report for 10.10.10.50
Host is up (0.0015s latency).
Nmap scan report for 10.10.10.55
Host is up (0.0018s latency).
Nmap scan report for 10.10.10.60
Host is up (0.0020s latency).

Nmap done at Fri Sep 12 10:45:30 2024 -- 256 IP addresses (15 hosts up) scanned in 30.00 seconds
```
- For the domain provided in the [Scope](#scope), demonstrate how you can do a subdomain enumeration using a tool like `aiodnsbrute`. 

# Service Discovery and Port Scanning
- Now you have a fair idea of the hosts that respond to pings. Explain why you have to do service discovery / port scanning and why it is necessary. 
- Using _Nmap_ do a service discovery and save the output into a greppable nmap file. 
- Separate the output of the results into their respective protocols. 
- Use the data below as a guide

```nmap
# Nmap 7.80 scan initiated Fri Sep 12 11:00:00 2024

Nmap scan report for 10.10.10.2
Host is up (0.0010s latency).
PORT    STATE SERVICE VERSION
80/tcp  open  http    Apache httpd 2.4.49
443/tcp open  ssl/http Apache httpd 2.4.49

Nmap scan report for 10.10.10.5
Host is up (0.0012s latency).
PORT    STATE SERVICE  VERSION
3306/tcp open mysql    MySQL 5.6.49 

Nmap scan report for 10.10.10.10
Host is up (0.0015s latency).
PORT     STATE SERVICE VERSION
5900/tcp open  vnc     RealVNC 5.3.2 

Nmap scan report for 10.10.10.11
Host is up (0.0014s latency).
PORT     STATE SERVICE  VERSION
3389/tcp open  rdp      Microsoft Terminal Services

Nmap scan report for 10.10.10.15
Host is up (0.0017s latency).
PORT     STATE SERVICE  VERSION
25/tcp   open  smtp     Exim smtpd 4.92

Nmap scan report for 10.10.10.20
Host is up (0.0020s latency).
PORT    STATE SERVICE  VERSION
23/tcp  open  telnet   BSD telnetd

Nmap scan report for 10.10.10.21
Host is up (0.0018s latency).
PORT    STATE SERVICE  VERSION
139/tcp open  netbios-ssn Samba 3.6.25 
445/tcp open  microsoft-ds Windows 7 - Samba file sharing

Nmap scan report for 10.10.10.30
Host is up (0.0019s latency).
PORT    STATE SERVICE VERSION
80/tcp  open  http    Apache httpd 2.4.49 
9020/tcp open http    Apache httpd 2.4.49

Nmap scan report for 10.10.10.31
Host is up (0.0017s latency).
PORT     STATE SERVICE  VERSION
3389/tcp open  rdp      Microsoft Terminal Services 

Nmap scan report for 10.10.10.40
Host is up (0.0016s latency).
PORT    STATE SERVICE  VERSION
3306/tcp open mysql    MySQL 5.5.62 

Nmap scan report for 10.10.10.45
Host is up (0.0022s latency).
PORT     STATE SERVICE  VERSION
443/tcp  open  ssl/http Apache httpd 2.4.49 

Nmap scan report for 10.10.10.50
Host is up (0.0015s latency).
PORT     STATE SERVICE  VERSION
5900/tcp open  vnc      UltraVNC 1.2.1.7

Nmap scan report for 10.10.10.55
Host is up (0.0018s latency).
PORT    STATE SERVICE VERSION
80/tcp  open  http    Apache httpd 2.4.49
8898/tcp open http    Apache httpd 2.4.49

Nmap scan report for 10.10.10.60
Host is up (0.0020s latency).
PORT     STATE SERVICE  VERSION
3389/tcp open  rdp      Microsoft Terminal Services

# Nmap done at Fri Sep 12 11:02:30 2024 -- 14 IP addresses (14 hosts up) scanned in 2 minutes 30 seconds
```
- Take note of the service versions, use resources like Exploitdb and [MITRE CVE](https://cve.mitre.org/cve/search_cve_list.html) to identify relevant vulnerabilities associated with the services indicated in the data above. 

# Vulnerability Scanning
- Using your protocol specific file you created under service discovery, scan for vulnerabilities with the _Metasploit Auxilliary module_. (Scan for login vulnerabilities - common credentials for the following services: mysql, vnc, rdp, smb), use appropriate wordlists for these services.
- Assuming you have to develop your own custom wordlist, demonstrate how you will go about that using `cewl`. Describe situations when it will be needed to 
- Show the procedure used during scanning of the vulnerabilites associated with these services
- Take screenshots of revelant commands to support your descriptions

# Web-Based Attack Surfaces
- Now, using your http/https hosts file, use `eyewitness` to show the command and options that you will use to open the links and take screenshots of the web servers. 
- Include options for `eyewitness` to load non-standard http/https ports.

# Generating Payloads
- Now, assuming host `10.10.10.55` runs an Apache Tomcat web server(Java based), explain how you will use `msfvenom` to generate a payload that can trigger a TCP bind shell when executed by an attacker
- Do same for host `10.10.10.30` with the assumption it is running a Python server that can execute `base64` encoded payloads.
- Take screenshots after running the commands to create the payloads using `msfvenom` and also the directory containing both payloads for the Java server and the Python server after generating the payloads